# Pathology Detector training pipeline 
Небольшой пайплайн для проведения экспериментов с классификацией растений и их заболеваний
## Содержание
1. [Установка](#установка)
2. [Возможности](#возможности)
3. [Проведение эксперимента](#проведение_эксперимента)

<a name="установка"/>

## Установка

Для установка данного пайплайна необходимо скопировать репозиторий себе на компьютер.
Работа с пайплайном происходит внутри папки training_pipeline, 
все вспомогательные файлы при работе будут создаваться внутри этой папки

<a name="возможности"/>

## Возможности

При помощи данного пайплайна можно проводить эксперименты с классификацией растений/заболеваний.
Он представляет из себя несколько связных ноутбуков, в каждом из которых находится отдельная часть пайплайна.
Также он включает в себя конфиг файл, в котором можно настроить основные детали эксперимента, такие как:
* Высотка картинки
* Ширина картинки
* количество эпох
* размер батча
* нужно ли подгатавливать датасеты
* нужно ли тренировать модель
* пути до используемых датасетов и пути до ноутбуков, которые их преобразают к единому виду
* делать ли аугментацию
* название модели
* путь до архитектуры модели (если None, то создается новая модель)
* путь до весов модели

Любые ноутбки можно менять под свои нужды, например, поменять аугментации в файле [DataGenerator.py](https://github.com/Skeef79/Pathology-Detector/blob/master/training_pipeline/DataGenerator.py)

Данный пайплайн позволяет легко добавлять новые датасеты для тренировки. Чтобы это сделать, необходимо
написать ноутбук, который преобразует этот датасет и добавить в конфиг кортеж вида (путь к датасету, путь к ноутбуку).
Пример написания такого ноутбка можно посмотреть здесь: [plant_pathology_2020_transform.ipynb](https://github.com/Skeef79/Pathology-Detector/blob/master/training_pipeline/data_transforms/plant_pathology_2020_transform.ipynb)

В пайплайне поддерживается система экспериментов. После каждого запуска создается папка с результатами эксперимента. Данная папка включает в себя:
* блокнот с визуализацией
* конфиг, с которым был запущен эксперимент
* описание, с которым был запущен эксперимент
* архитектура модели
* веса модели
* график истории обучения
* метрики

<a name = "проведение_эксперимента"/>

## Проведение эксперимента

1. Настроить [конфиг](https://github.com/Skeef79/Pathology-Detector/blob/master/training_pipeline/config.json) файл.
Это можно сделать при помощи блокнота [change_config.ipynb](https://github.com/Skeef79/Pathology-Detector/blob/master/training_pipeline/change_config.ipynb). Перед запуском эксперимента необходимо настроить параметры в этом файле и запустить его. Он автоматически поменять файл [config.json](https://github.com/Skeef79/Pathology-Detector/blob/master/training_pipeline/config.json)
2. Написать цели и ожидаемый результат эксперимента в файле [description.txt](https://github.com/Skeef79/Pathology-Detector/blob/master/training_pipeline/description.txt) (конечно, это не обязательно, но без этого не понятно зачем проводился эксперимент)
3. Запустить ноутбук [run_pipeline.ipynb](https://github.com/Skeef79/Pathology-Detector/blob/master/training_pipeline/run_pipeline.ipynb)

После этих действий у вас создастся папка experiments(если еще не была создана) и туда запишется результат эксперимента (папка по названию модели, в которой хранится информацию, описанная в пункте "Возможности"). 

_Будьте аккуратнее с названиями, так как если у вас уже есть эксперимент с таким названием, то выбросится исключение, это сделана для того, чтобы не потерять результаты предыдущих экспериментов. Название папки = названию модели в конфиге_
